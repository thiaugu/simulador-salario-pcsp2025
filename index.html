<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Simulador de Remuneração - PCSP</title>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>

    <!-- React Libraries -->
    <script src="https://unpkg.com/react@17/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@17/umd/react-dom.development.js"></script>

    <!-- Babel to transpile JSX in the browser -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

    <style>
        /* Custom font for better readability */
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800;900&display=swap');
        body {
            font-family: 'Inter', sans-serif;
        }
        /* Minor style adjustments */
        .focus\:ring-cyan-600:focus {
            --tw-ring-color: #0891b2;
        }
    </style>
</head>
<body class="bg-gray-900">
    <div id="root"></div>

    <script type="text/babel">
        // --- DEPENDENCIES & SETUP (React Hooks, etc.) ---
        const { useState, useEffect, useMemo } = React;

        // --- SVG ICONS (replacement for lucide-react) ---
        const Briefcase = ({ className }) => (<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><rect width="20" height="14" x="2" y="7" rx="2" ry="2" /><path d="M16 21V5a2 2 0 0 0-2-2h-4a2 2 0 0 0-2 2v16" /></svg>);
        const Clock = ({ className }) => (<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><circle cx="12" cy="12" r="10" /><polyline points="12 6 12 12 16 14" /></svg>);
        const Users = ({ className }) => (<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><path d="M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2" /><circle cx="9" cy="7" r="4" /><path d="M22 21v-2a4 4 0 0 0-3-3.87" /><path d="M16 3.13a4 4 0 0 1 0 7.75" /></svg>);
        const Shield = ({ className }) => (<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z" /></svg>);
        const Award = ({ className }) => (<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><circle cx="12" cy="8" r="7" /><polyline points="8.21 13.89 7 23 12 17 17 23 15.79 13.88" /></svg>);
        const FileText = ({ className }) => (<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><path d="M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z" /><polyline points="14 2 14 8 20 8" /><line x1="16" y1="13" x2="8" y2="13" /><line x1="16" y1="17" x2="8" y2="17" /><line x1="10" y1="9" x2="8" y2="9" /></svg>);
        const HelpCircle = ({ className }) => (<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><circle cx="12" cy="12" r="10" /><path d="M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3" /><line x1="12" y1="17" x2="12.01" y2="17" /></svg>);
        const HandCoins = ({ className }) => (<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><path d="M11 15h2a2 2 0 1 0 0-4h-3c-.6 0-1.1.2-1.4.6L3 17" /><path d="m7 21 1.6-1.4c.3-.4.8-.6 1.4-.6h4c1.1 0 2.1-.4 2.8-1.2l4.6-4.4a2 2 0 0 0-2.7-2.9l-4.4 4.3a2 2 0 0 1-2.8 0l-4.4-4.4a2 2 0 0 0-2.8 2.8l4.4 4.4C6.4 19.9 7 20.5 7 21Z" /><circle cx="16" cy="7" r="2" /><circle cx="18" cy="9" r="2" /></svg>);
        const AlertTriangle = ({ className }) => (<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><path d="m21.73 18-8-14a2 2 0 0 0-3.46 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z" /><line x1="12" y1="9" x2="12" y2="13" /><line x1="12" y1="17" x2="12.01" y2="17" /></svg>);
        const InstagramIcon = ({ className }) => (<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><rect width="20" height="20" x="2" y="2" rx="5" ry="5"></rect><path d="M16 11.37A4 4 0 1 1 12.63 8 4 4 0 0 1 16 11.37z"></path><line x1="17.5" x2="17.51" y1="6.5" y2="6.5"></line></svg>);
        const University = ({ className }) => (<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><circle cx="12" cy="10" r="3" /><path d="M19 22V6" /><path d="M5 22V6" /><path d="M12 19L5 15V9l7 4 7-4v6l-7 4Z" /></svg>);

        // --- DATA & CONSTANTS ---
        const salaryData = {
          "Delegado de Polícia": { "3ª Classe": 7894.94, "2ª Classe": 8412.14, "1ª Classe": 8967.82, "Classe Especial": 9499.12 },
          "Médico Legista": { "3ª Classe": 6801.06, "2ª Classe": 7245.58, "1ª Classe": 7723.00, "Classe Especial": 8178.62 },
          "Perito Criminal": { "3ª Classe": 6801.06, "2ª Classe": 7245.58, "1ª Classe": 7723.00, "Classe Especial": 8178.62 },
          "Escrivão de Polícia": { "3ª Classe": 3086.83, "2ª Classe": 3306.60, "1ª Classe": 3543.17, "Classe Especial": 3902.29 },
          "Investigador de Polícia": { "3ª Classe": 3086.83, "2ª Classe": 3306.60, "1ª Classe": 3543.17, "Classe Especial": 3902.29 },
        };
        const constants = { 
            adpjCoefficient: 0.265, 
            irpfDeductionPerDependent: 189.59, 
            ufesp: 37.02,
            dejecCoefficients: { delegado: 9.6, outros: 8.0 },
            inssCeiling: 8157.41,
        };
        const proLaboreData = {
            operacionais: {
                "Escrivão/Investigador-Chefe": 0.1080,
                "Chefe de Seção/Equipe": 0.0950,
                "Encarregado/Encarregado de Equipe": 0.0720,
            },
            peritos: {
                "Diretor Técnico de Departamento": 0.1240,
                "Diretor Técnico de Divisão": 0.1000,
                "Diretor Técnico de Serviço": 0.0830,
                "Chefe de Seção Técnica": 0.0660,
                "Encarregado de Setor Técnico": 0.0580,
            },
            delegados: {
                "Chefe de Assistência Policial Civil": 0.1240,
                "Delegado de Polícia Diretor de Departamento": 0.1240,
                "Delegado Regional de Polícia": 0.1160,
                "Delegado Divisionário de Polícia": 0.1000,
                "Delegado Seccional de Polícia I e II": 0.0830,
            }
        };
        const alimentacaoRules = { valor12h: 2 * constants.ufesp, valor8h: 1 * constants.ufesp, limite12h: 15, limite8h: 30, limiteMensalTotal: 15 * (2 * constants.ufesp) };
        const insalubridadeValues = { "Máximo": 785.67, "Mínimo": 196.38, "Nenhum": 0 };
        const activityToLevelMap = { "Não se aplica": "Nenhum", "Atividade Operacional": "Máximo", "Atividade Administrativa (Readaptado)": "Mínimo" };
        const activityOptions = ["Não se aplica", "Atividade Operacional", "Atividade Administrativa (Readaptado)"];
        const iamspeRates = { titular: { under59: 0.02, over59: 0.03 }, beneficiario: { under59: 0.005, over59: 0.01 }, agregado: { under59: 0.02, over59: 0.03 } };

        // --- HELPER FUNCTIONS ---
        const formatCurrency = (value) => new Intl.NumberFormat('pt-BR', { style: 'currency', currency: 'BRL' }).format(value || 0);
        const calculateSpprev = (base) => {
          const limits = [1518.00, 4022.46, 8157.41], rates = [0.11, 0.12, 0.14, 0.16];
          if (base <= limits[0]) return base * rates[0];
          if (base <= limits[1]) return (limits[0] * rates[0]) + ((base - limits[0]) * rates[1]);
          if (base <= limits[2]) return (limits[0] * rates[0]) + ((limits[1] - limits[0]) * rates[1]) + ((base - limits[1]) * rates[2]);
          return (limits[0] * rates[0]) + ((limits[1] - limits[0]) * rates[1]) + ((limits[2] - limits[1]) * rates[2]) + ((base - limits[2]) * rates[3]);
        };
        const calculateIrpf = (base) => {
          const limits = [2259.20, 2826.65, 3751.05, 4664.68], rates = [0.075, 0.15, 0.225, 0.275], deductions = [169.44, 381.44, 662.77, 896.00];
          let tax = 0;
          if (base > limits[3]) tax = (base * rates[3]) - deductions[3];
          else if (base > limits[2]) tax = (base * rates[2]) - deductions[2];
          else if (base > limits[1]) tax = (base * rates[1]) - deductions[1];
          else if (base > limits[0]) tax = (base * rates[0]) - deductions[0];
          return tax > 0 ? tax : 0;
        };

        // --- REUSABLE UI COMPONENTS ---
        const InputSection = ({ icon: Icon, title, children }) => {
            return (<div className="p-4 bg-gray-900/50 rounded-lg ring-1 ring-gray-700/50"> <div className="flex items-center gap-3 mb-4"> <Icon className="w-6 h-6 text-cyan-400" /> <h3 className="font-semibold text-lg text-cyan-300">{title}</h3> </div> <div className="space-y-4">{children}</div> </div>);
        };
        const Select = ({ label, value, onChange, options, helpText }) => {
            return (<div> <label className="block text-sm font-medium text-gray-300 mb-1">{label}</label> <select value={value} onChange={onChange} className="w-full bg-gray-700 border-gray-600 rounded-md py-2 px-3 text-white focus:ring-2 focus:ring-cyan-500 focus:border-cyan-500"> {options.map(opt => <option key={opt.value} value={opt.value}>{opt.label}</option>)} </select> {helpText && <p className="text-xs text-gray-400 mt-1">{helpText}</p>} </div>);
        };
        const NumberInput = ({ label, value, onChange, helpText, min = 0, max }) => {
            return (<div> <label className="block text-sm font-medium text-gray-300 mb-1">{label}</label> <input type="number" value={value} onChange={e => { let val = parseInt(e.target.value) || 0; val = Math.max(min, val); if (max !== undefined) val = Math.min(max, val); onChange(val); }} className="w-full bg-gray-700 border-gray-600 rounded-md py-2 px-3 text-white" /> {helpText && <p className="text-xs text-gray-400 mt-1">{helpText}</p>} </div>);
        };
        const Checkbox = ({ label, checked, onChange, helpText }) => {
            return (<div className="flex items-start"> <input type="checkbox" id={label} checked={checked} onChange={e => onChange(e.target.checked)} className="h-4 w-4 rounded bg-gray-700 text-cyan-500 mt-1 focus:ring-cyan-600" /> <div className="ml-3"> <label htmlFor={label} className="text-sm text-gray-200">{label}</label> {helpText && <p className="text-xs text-gray-400">{helpText}</p>} </div> </div>);
        };
        const ToggleSwitch = ({ label, enabled, setEnabled, helpText }) => {
            return (<div className="flex items-center justify-between"> <div> <label className="font-medium text-gray-200">{label}</label> {helpText && <p className="text-xs text-gray-400 mt-1">{helpText}</p>} </div> <button onClick={() => setEnabled(!enabled)} className={`${enabled ? 'bg-cyan-500' : 'bg-gray-600'} relative inline-flex h-6 w-11 items-center rounded-full transition-colors`}> <span className={`${enabled ? 'translate-x-6' : 'translate-x-1'} inline-block h-4 w-4 transform rounded-full bg-white transition-transform`} /> </button> </div>);
        };
        const ResultRow = ({ label, value, helpText, isTotal = false, type = 'neutral', children }) => { 
            const colorClasses = { neutral: 'text-white', positive: 'text-green-300', negative: 'text-red-300' }; 
            return ( 
                <div className={`py-2 ${isTotal ? 'border-t border-gray-600 mt-2 pt-2' : ''}`}>
                    <div className={`flex justify-between items-center ${isTotal ? 'text-base font-bold' : 'text-sm'}`}>
                        <span>{label}</span>
                        <span className={`font-mono ${colorClasses[type]}`}>{value}</span>
                    </div>
                    {children && <div className="mt-1 space-y-0.5">{children}</div>}
                    {helpText && <p className="text-xs text-gray-400 mt-1">{helpText}</p>}
                </div>
            ); 
        };
        const ResultSubRow = ({ label, value }) => {
            return (
                <div className="flex justify-between items-center text-xs text-gray-400/80 pl-2 italic">
                    <span>{label}</span>
                    <span className="font-mono">{value}</span>
                </div>
            );
        };
        
        // --- TOOLTIP COMPONENTS ---
        const BaseSalaryTooltip = () => {
            return (
                <div className="absolute bottom-full left-1/2 -translate-x-1/2 mb-2 w-96 max-w-lg p-4 bg-gray-950 border border-cyan-700/50 rounded-lg shadow-xl z-10 text-xs text-gray-300">
                    <div className="space-y-3">
                        <h4 className="font-bold text-sm text-cyan-400">Tabela de Vencimentos Padrão</h4>
                        <table className="w-full text-left text-[11px]">
                            <thead className="bg-gray-800/70">
                                <tr>
                                    <th className="p-1.5">Cargo</th>
                                    <th className="p-1.5">Classe</th>
                                    <th className="p-1.5 text-right">Salário Base</th>
                                </tr>
                            </thead>
                            <tbody>
                                {Object.entries(salaryData).map(([career, classes]) => (
                                    Object.entries(classes).map(([className, salary], index) => (
                                        <tr key={`${career}-${className}`} className="border-t border-gray-700/50">
                                            {index === 0 && <td rowSpan={Object.keys(classes).length} className="p-1.5 align-top font-semibold">{career}</td>}
                                            <td className="p-1.5">{className}</td>
                                            <td className="p-1.5 text-right font-mono">{formatCurrency(salary)}</td>
                                        </tr>
                                    ))
                                ))}
                            </tbody>
                        </table>
                        <p className="text-amber-300 text-center pt-2 border-t border-amber-300/20">
                            Valores atualizados com o reajuste de 5% (LC 1.425/2025). 
                            <a href="https://doe.sp.gov.br/executivo/leis-complementares/lei-complementar-n-1425-d-02062025-de-2-de-junho-de-2025-202506021142111118689" target="_blank" rel="noopener noreferrer" className="text-cyan-400 hover:underline ml-1">
                                Ver Diário Oficial
                            </a>
                        </p>
                    </div>
                </div>
            );
        };
        const TemporalCalculationTooltip = () => {
            return (
                <div className="absolute top-full left-0 mt-2 w-80 max-w-xs p-4 bg-gray-950 border border-cyan-700/50 rounded-lg shadow-xl z-10 text-xs text-gray-300">
                    <div className="space-y-3">
                        <h4 className="font-bold text-sm text-cyan-400">Base de Cálculo das Vantagens</h4>
                        <p><strong className="text-white">Cálculo Administrativo (Padrão):</strong> Os adicionais (Quinquênio e Sexta-Parte) são calculados sobre o Salário Base + Pro Labore, conforme a prática padrão da administração pública.</p>
                        <p><strong className="text-white">Cálculo Judicial (Venc. Integrais):</strong> Os adicionais são calculados sobre os vencimentos integrais (Salário Base + RETP + Pro Labore), geralmente uma condição obtida por meio de ação judicial.</p>
                        <p className="text-amber-300">Escolha a opção que reflete sua situação funcional para uma simulação mais precisa.</p>
                    </div>
                </div>
            );
        };
        const PensionRegimeTooltip = () => {
            return (
                <div className="absolute top-full left-0 mt-2 w-80 max-w-xs p-4 bg-gray-950 border border-cyan-700/50 rounded-lg shadow-xl z-10 text-xs text-gray-300">
                    <div className="space-y-3">
                        <h4 className="font-bold text-sm text-cyan-400">Regime de Previdência</h4>
                        <p><strong className="text-white">Regime Antigo (RPPS):</strong> Para quem ingressou no serviço público estadual antes de 21/01/2013. A contribuição SPPREV incide sobre a remuneração total.</p>
                        <p><strong className="text-white">Regime Novo (RPC):</strong> Para quem ingressou a partir de 21/01/2013. A contribuição SPPREV incide apenas sobre o teto do INSS. Permite contribuição opcional para a SP-PREVCOM.</p>
                    </div>
                </div>
            );
        };
        const PrevcomTooltip = () => {
             return (
                <div className="absolute top-full left-0 mt-2 w-80 max-w-xs p-4 bg-gray-950 border border-cyan-700/50 rounded-lg shadow-xl z-10 text-xs text-gray-300">
                    <div className="space-y-3">
                        <h4 className="font-bold text-sm text-cyan-400">Previdência Complementar (SP-PREVCOM)</h4>
                        <p>Para servidores do Regime Novo, é uma contribuição opcional sobre a parcela do salário que excede o teto do INSS.</p>
                        <p className="text-amber-300">O Estado contribui com o mesmo valor que o servidor (contrapartida de 1 para 1), até o limite de 7,5%.</p>
                    </div>
                </div>
            );
        };
        const IamspeContributionTooltip = () => {
            return (
                <div className="absolute top-full left-0 mt-2 w-80 max-w-xs p-4 bg-gray-950 border border-cyan-700/50 rounded-lg shadow-xl z-10 text-xs text-gray-300">
                    <div className="space-y-3">
                        <h4 className="font-bold text-sm text-cyan-400">Modalidade de Contribuição IAMSPE</h4>
                        <p><strong className="text-white">Obrigatório:</strong> Conforme a Lei nº 17.293/2020, a contribuição é compulsória para todos os servidores, com alíquotas que variam conforme a idade.</p>
                        <p><strong className="text-white">Sem Contribuição (Decisão Judicial):</strong> Selecione esta opção caso você possua uma decisão judicial que o desobrigue de contribuir para o IAMSPE.</p>
                    </div>
                </div>
            );
        };
        const ProLaboreExplanationTooltip = () => {
            return (
                <div className="absolute top-full left-0 mt-2 w-80 max-w-xs p-4 bg-gray-950 border border-cyan-700/50 rounded-lg shadow-xl z-10 text-xs text-gray-300">
                    <div className="space-y-3">
                        <h4 className="font-bold text-sm text-cyan-400">Gratificação Pro Labore</h4>
                        <p>É uma gratificação paga pelo exercício de funções de chefia, encarregatura ou direção, variando conforme a carreira e a função.</p>
                        <p className="text-amber-300">Esta gratificação é incorporada na base de cálculo das vantagens temporais (Quinquênio e Sexta-Parte).</p>
                    </div>
                </div>
            );
        };
        const ProLaboreCalculationTooltip = ({ base, percent, careerType }) => {
            let baseLabel = "do Cargo";
            if (careerType === 'operacionais' || careerType === 'delegados') {
                baseLabel = "Classe Especial";
            }

            return (
                <div className="absolute bottom-full left-1/2 -translate-x-1/2 mb-2 w-80 max-w-xs p-4 bg-gray-950 border border-cyan-700/50 rounded-lg shadow-xl z-10 text-xs text-gray-300">
                    <div className="space-y-3">
                        <h4 className="font-bold text-sm text-cyan-400">Cálculo do Pro Labore</h4>
                        <p className="font-mono text-center bg-gray-800 p-2 my-1 rounded text-cyan-300 text-[11px]">Base de Cálculo × Percentual</p>
                        <ul className="list-none space-y-1 text-gray-400">
                            <li className="flex justify-between"><span>Base de Cálculo:</span> <span>{formatCurrency(base)}</span></li>
                            <li className="flex justify-between"><span>(Sal. Padrão {baseLabel})</span></li>
                            <li className="flex justify-between"><span>Percentual:</span> <span>{(percent * 100).toFixed(2)}%</span></li>
                        </ul>
                    </div>
                </div>
            );
        };
        const GatExplanationTooltip = () => {
             return (
                <div className="absolute top-full left-0 mt-2 w-80 max-w-xs p-4 bg-gray-950 border border-cyan-700/50 rounded-lg shadow-xl z-10 text-xs text-gray-300">
                    <div className="space-y-3">
                        <h4 className="font-bold text-sm text-cyan-400">Gratificação por Acúmulo de Titularidade (GAT)</h4>
                        <p>Indenização para Delegados que respondem cumulativamente por unidades ou substituem titulares.</p>
                        <p className="text-amber-300">Não se incorpora aos vencimentos e não sofre descontos previdenciários ou de assistência médica.</p>
                    </div>
                </div>
            );
        };
         const GatCalculationTooltip = ({ base, days }) => {
            return (
                <div className="absolute bottom-full left-1/2 -translate-x-1/2 mb-2 w-80 max-w-xs p-4 bg-gray-950 border border-cyan-700/50 rounded-lg shadow-xl z-10 text-xs text-gray-300">
                    <div className="space-y-3">
                        <h4 className="font-bold text-sm text-cyan-400">Cálculo da GAT</h4>
                        <p className="font-mono text-center bg-gray-800 p-2 my-1 rounded text-cyan-300 text-[11px]">(Salário Base / 30) × Dias de Acúmulo</p>
                        <ul className="list-none space-y-1 text-gray-400">
                            <li className="flex justify-between"><span>Salário Base:</span> <span>{formatCurrency(base)}</span></li>
                            <li className="flex justify-between"><span>Dias:</span> <span>{days}</span></li>
                        </ul>
                    </div>
                </div>
            );
        };
        const AlimentacaoRulesTooltip = () => {
            return (<div className="absolute top-full left-0 mt-2 w-80 max-w-xs p-4 bg-gray-950 border border-cyan-700/50 rounded-lg shadow-xl z-10 text-xs text-gray-300"> <div className="space-y-3"> <h4 className="font-bold text-sm text-cyan-400">Cálculo da Ajuda de Custo (Alimentação)</h4> <p>Funciona como uma indenização por plantão trabalhado:</p> <ul className="list-disc list-inside space-y-1 text-gray-400"> <li><strong className="text-white">Plantão de 12h ou mais:</strong> Recebe 100% do valor de referência.</li> <li><strong className="text-white">Plantão de 8 a 12h:</strong> Recebe 50% do valor de referência.</li> </ul> <p>O valor total mensal não pode ultrapassar o teto de 15 plantões de 12h.</p> </div> </div>);
        };
        const DejecExplanationTooltip = () => {
            return (<div className="absolute top-full left-0 mt-2 w-80 max-w-xs p-4 bg-gray-950 border border-cyan-700/50 rounded-lg shadow-xl z-10 text-xs text-gray-300"> <div className="space-y-3"> <h4 className="font-bold text-sm text-cyan-400">Diária Especial por Jornada Extraordinária (DEJEC)</h4> <p>Indenização por 8h contínuas de trabalho fora da jornada normal, limitada a 10 diárias/mês (LC 1.280/2016).</p><p className="text-amber-300">A lei veda o recebimento de auxílio-alimentação no período de atividade da DEJEC.</p> </div> </div>);
        };
        const RetpExplanationTooltip = () => {
            return (<div className="absolute bottom-full left-1/2 -translate-x-1/2 mb-2 w-80 max-w-xs p-4 bg-gray-950 border border-cyan-700/50 rounded-lg shadow-xl z-10 text-xs text-gray-300"> <div className="space-y-3"> <h4 className="font-bold text-sm text-cyan-400">Regime Especial de Trabalho Policial (RETP)</h4> <p className="text-gray-400">Lei n.º 10.291, de 26 de novembro de 1968:</p> <blockquote className="border-l-2 border-cyan-500/50 pl-3 text-gray-300 space-y-2"> <p><strong className="text-white">Artigo 1º</strong> - Fica instituído, na Secretaria da Segurança Pública, o Regime Especial de Trabalho Policial...</p> <p><strong className="text-white">Artigo 3º</strong> - ...ficam atribuídas... gratificações na seguinte conformidade:</p> <p className="pl-4"><strong className="text-white">II</strong> - 100% (cem por cento) sobre as respectivas referências de vencimentos...</p> </blockquote> </div> </div>);
        };
        const IamspeExplanationTooltip = () => {
            return (<div className="absolute bottom-full left-1/2 -translate-x-1/2 mb-2 w-80 max-w-xs p-4 bg-gray-950 border border-cyan-700/50 rounded-lg shadow-xl z-10 text-xs text-gray-300"> <div className="space-y-3"> <h4 className="font-bold text-sm text-cyan-400">Cálculo da Contribuição IAMSPE</h4> <p>O cálculo é feito sobre a remuneração bruta total, com alíquotas variando por faixa etária (Lei nº 17.293/2020):</p> <ul className="list-none space-y-2 text-gray-400"> <li><strong className="text-white block">Titular:</strong><span className="flex justify-between pl-2"><span>&lt; 59 anos:</span> <span>2%</span></span><span className="flex justify-between pl-2"><span>59+ anos:</span> <span>3%</span></span></li> <li><strong className="text-white block">Beneficiários (cônjuge/filhos):</strong><span className="flex justify-between pl-2"><span>&lt; 59 anos:</span> <span>0,5%</span></span><span className="flex justify-between pl-2"><span>59+ anos:</span> <span>1%</span></span></li> <li><strong className="text-white block">Agregados (pais/padrastos):</strong><span className="flex justify-between pl-2"><span>&lt; 59 anos:</span> <span>2%</span></span><span className="flex justify-between pl-2"><span>59+ anos:</span> <span>3%</span></span></li> </ul> <p>O desconto final é a soma da contribuição do titular com a de cada dependente.</p> </div> </div>);
        };
        const SpprevExplanationTooltip = () => {
            return (<div className="absolute bottom-full left-1/2 -translate-x-1/2 mb-2 w-80 max-w-xs p-4 bg-gray-950 border border-cyan-700/50 rounded-lg shadow-xl z-10 text-xs text-gray-300"> <div className="space-y-3"> <h4 className="font-bold text-sm text-cyan-400">Cálculo da Contribuição SPPREV</h4> <p>A contribuição é progressiva sobre o Total Bruto, aplicada em faixas (valores de 2025):</p> <ul className="list-disc list-inside space-y-1 text-gray-400"> <li><strong className="text-white">1ª Faixa:</strong> 11% sobre a parte do salário até R$ 1.518,00.</li> <li><strong className="text-white">2ª Faixa:</strong> 12% sobre a parte de R$ 1.518,01 até R$ 4.022,46.</li> <li><strong className="text-white">3ª Faixa:</strong> 14% sobre a parte de R$ 4.022,47 até R$ 8.157,41.</li> <li><strong className="text-white">4ª Faixa:</strong> 16% sobre a parte que ultrapassa R$ 8.157,41.</li> </ul> <p>O desconto final é a soma dos valores calculados em cada faixa.</p> </div> </div>);
        };
        const IrpfExplanationTooltip = () => {
            return (
                <div className="absolute bottom-full left-1/2 -translate-x-1/2 mb-2 w-80 max-w-xs p-4 bg-gray-950 border border-cyan-700/50 rounded-lg shadow-xl z-10 text-xs text-gray-300">
                    <div className="space-y-3">
                        <h4 className="font-bold text-sm text-cyan-400">Cálculo do IRPF</h4>
                        <p>O desconto não incide sobre o salário bruto total, mas sobre uma base de cálculo específica, em 3 etapas:</p>
                        <div>
                            <h5 className="font-bold text-white">1. Base de Cálculo</h5>
                            <p className="font-mono text-center bg-gray-800 p-2 my-1 rounded text-cyan-300 text-[11px]">Total Bruto - SPPREV - IAMSPE - (Dependentes × R$ 189,59)</p>
                        </div>
                        <div>
                            <h5 className="font-bold text-white">2. Tabela Progressiva</h5>
                            <table className="w-full text-left my-1 text-[10px] sm:text-[11px]">
                                <thead className="bg-gray-800/70">
                                    <tr>
                                        <th className="p-1.5">Base (R$)</th>
                                        <th className="p-1.5">Alíquota</th>
                                        <th className="p-1.5">Dedução (R$)</th>
                                    </tr>
                                </thead>
                                <tbody className="bg-gray-900/50">
                                    <tr>
                                        <td className="p-1.5">Até 2.259,20</td>
                                        <td className="p-1.5">Isento</td>
                                        <td className="p-1.5">0,00</td>
                                    </tr>
                                    <tr>
                                        <td className="p-1.5">a 2.826,65</td>
                                        <td className="p-1.5">7,5%</td>
                                        <td className="p-1.5">169,44</td>
                                    </tr>
                                    <tr>
                                        <td className="p-1.5">a 3.751,05</td>
                                        <td className="p-1.5">15%</td>
                                        <td className="p-1.5">381,44</td>
                                    </tr>
                                    <tr>
                                        <td className="p-1.5">a 4.664,68</td>
                                        <td className="p-1.5">22,5%</td>
                                        <td className="p-1.5">662,77</td>
                                    </tr>
                                    <tr>
                                        <td className="p-1.5">&gt; 4.664,68</td>
                                        <td className="p-1.5">27,5%</td>
                                        <td className="p-1.5">896,00</td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                        <div>
                            <h5 className="font-bold text-white">3. Fórmula Final</h5>
                            <p className="font-mono text-center bg-gray-800 p-2 my-1 rounded text-cyan-300 text-[11px]">(Base de Cálculo × Alíquota) - Parcela a Deduzir</p>
                        </div>
                    </div>
                </div>
            );
        };
        const AdpjExplanationTooltip = () => {
            return (<div className="absolute bottom-full left-1/2 -translate-x-1/2 mb-2 w-80 max-w-xs p-4 bg-gray-950 border border-cyan-700/50 rounded-lg shadow-xl z-10 text-xs text-gray-300"> <div className="space-y-3"> <h4 className="font-bold text-sm text-cyan-400">Adicional por Direção da Atividade de Polícia Judiciária (ADPJ)</h4> <p>Gratificação exclusiva para Delegados de Polícia, remunerando a natureza de comando e gestão do cargo.</p> <div> <h5 className="font-bold text-white">Cálculo</h5> <p className="font-mono text-center bg-gray-800 p-2 my-1 rounded text-cyan-300 text-[11px]">(Salário Base + RETP) * 26,5%</p> </div> <p>É uma vantagem específica da carreira, não sendo estendida aos demais cargos.</p> </div> </div>);
        };
        const InsalubridadeValueTooltip = () => {
            return (<div className="absolute bottom-full left-1/2 -translate-x-1/2 mb-2 w-80 max-w-xs p-4 bg-gray-950 border border-cyan-700/50 rounded-lg shadow-xl z-10 text-xs text-gray-300"> <div className="space-y-3"> <h4 className="font-bold text-sm text-cyan-400">Valores do Adicional de Insalubridade</h4> <p className="text-gray-400">Fonte: Comunicado Conjunto CAF/CRHE-1, de 01/03/2021.</p> <p>Os valores são fixos, correspondendo ao grau de risco da atividade:</p> <ul className="list-none space-y-1 text-gray-400"> <li className="flex justify-between"><strong className="text-white">Grau Máximo:</strong><span>{formatCurrency(insalubridadeValues["Máximo"])}</span></li> <li className="flex justify-between"><strong className="text-white">Grau Mínimo:</strong><span>{formatCurrency(insalubridadeValues["Mínimo"])}</span></li> </ul> </div> </div>);
        };
        const InsalubridadePortariaTooltip = () => {
            return (<div className="absolute top-full left-0 mt-2 w-80 max-w-xs p-4 bg-gray-950 border border-cyan-700/50 rounded-lg shadow-xl z-10 text-xs text-gray-300"> <p> Classificação conforme a Portaria DPME 3/2025. <a href="https://doe.sp.gov.br/executivo/secretaria-de-gestao-e-governo-digital/diretoria-de-pericias-medicas-do-estado-de-sao-paulo-portaria-n-03-de-24-de-marco-de-2025-202503241128511214965687" target="_blank" rel="noopener noreferrer" className="text-cyan-400 hover:underline ml-1" > Acesse aqui </a> </p> </div>);
        };
        const AlimentacaoValuesTooltip = () => {
            return (<div className="absolute bottom-full left-1/2 -translate-x-1/2 mb-2 w-80 max-w-xs p-4 bg-gray-950 border border-cyan-700/50 rounded-lg shadow-xl z-10 text-xs text-gray-300"> <div className="space-y-3"> <h4 className="font-bold text-sm text-cyan-400">Valores da Ajuda de Custo</h4> <p><strong className="text-white">Valor de Referência:</strong> 2,0 × {formatCurrency(constants.ufesp)} (UFESP) = <strong className="text-white">{formatCurrency(alimentacaoRules.valor12h)}</strong></p> <ul className="list-none space-y-1 text-gray-400"> <li className="flex justify-between"><strong className="text-white">Plantão de 12h ou mais:</strong><span>{formatCurrency(alimentacaoRules.valor12h)}</span></li> <li className="flex justify-between"><strong className="text-white">Plantão de 8 a 12h:</strong><span>{formatCurrency(alimentacaoRules.valor8h)}</span></li> </ul> <p>Este é um valor indenizatório, ou seja, não se incorpora ao salário e não sofre descontos de SPPREV ou IRPF.</p> </div> </div>);
        };
        const DejecCalculationTooltip = () => {
            return (<div className="absolute bottom-full left-1/2 -translate-x-1/2 mb-2 w-80 max-w-xs p-4 bg-gray-950 border border-cyan-700/50 rounded-lg shadow-xl z-10 text-xs text-gray-300"> <div className="space-y-3"> <h4 className="font-bold text-sm text-cyan-400">Cálculo da DEJEC</h4> <p>O valor é calculado multiplicando o número de diárias por um coeficiente aplicado sobre a UFESP.</p> <div> <h5 className="font-bold text-white">Coeficientes</h5> <ul className="list-none space-y-1 text-gray-400"> <li className="flex justify-between"><span>Delegado de Polícia:</span> <span>{constants.dejecCoefficients.delegado.toFixed(1)}</span></li> <li className="flex justify-between"><span>Demais Carreiras:</span> <span>{constants.dejecCoefficients.outros.toFixed(1)}</span></li> </ul> </div> <p className="font-mono text-center bg-gray-800 p-2 my-1 rounded text-cyan-300 text-[11px]">Nº Diárias × Coeficiente × {formatCurrency(constants.ufesp)}</p> </div> </div>);
        };

        // --- FLOATING BUTTON COMPONENT ---
        const FloatingAuthorButton = () => {
            return (<a href="https://www.instagram.com/provaspcsp2023/" target="_blank" rel="noopener noreferrer" className="fixed bottom-6 right-6 z-50 bg-gradient-to-tr from-yellow-400 via-red-500 to-purple-500 text-white p-3 rounded-full shadow-lg transition-transform duration-200 ease-in-out hover:scale-110 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-offset-gray-900 focus:ring-white" title="Desenvolvido por @provaspcsp2023. Clique para dúvidas ou sugestões." > <InstagramIcon className="w-6 h-6" /> </a>);
        };

        // --- MAIN APP COMPONENT ---
        function App() {
          // --- STATE MANAGEMENT ---
          const [inputs, setInputs] = useState({
            selectedCareer: "Delegado de Polícia", selectedClass: "3ª Classe",
            pensionRegime: 'rpps', // 'rpps' or 'rpc'
            showPrevcom: false,
            prevcomPercentage: 7.5,
            quinquenios: 0, hasSextaParte: false,
            calculationBase: 'admin', // 'admin' or 'judicial'
            showTemporalBenefits: false,
            activityType: 'Não se aplica', hasAbono: false, irpfDependents: 0,
            showProLabore: false, proLaboreFunction: 'none',
            iamspeContributionType: 'under59', // 'under59', 'over59', 'exempt'
            includeIamspeDependents: false,
            beneficiariosUnder59: 0, beneficiariosOver59: 0, agregadosUnder59: 0, agregadosOver59: 0,
            showAlimentacao: false, plantao12h: 0, plantao8h: 0,
            showDejec: false, dejecDiarias: 0,
            showGat: false, gatDays: 0,
          });
          const [showTooltips, setShowTooltips] = useState({});
          const toggleTooltip = (key) => setShowTooltips(prev => ({...prev, [key]: !prev[key]}));

          // --- DERIVED STATE & MEMOIZED VALUES ---
          const careerOptions = useMemo(() => Object.keys(salaryData).map(c => ({ value: c, label: c })), []);
          const classOptions = useMemo(() => { const career = inputs.selectedCareer; if (!career || !salaryData[career]) return []; return Object.keys(salaryData[career]).map(c => ({ value: c, label: c })); }, [inputs.selectedCareer]);
          
          const proLaboreCareerType = useMemo(() => {
            if (["Escrivão de Polícia", "Investigador de Polícia"].includes(inputs.selectedCareer)) return 'operacionais';
            if (["Médico Legista", "Perito Criminal"].includes(inputs.selectedCareer)) return 'peritos';
            if (inputs.selectedCareer === "Delegado de Polícia") return 'delegados';
            return null;
          }, [inputs.selectedCareer]);

          const proLaboreOptions = useMemo(() => {
            if (!proLaboreCareerType) return [];
            const functions = proLaboreData[proLaboreCareerType];
            return [{ value: 'none', label: 'Nenhuma' }, ...Object.keys(functions).map(f => ({ value: f, label: f }))];
          }, [proLaboreCareerType]);

          // --- EFFECT FOR AUTO-UPDATING SEXTA-PARTE ---
          useEffect(() => { if (inputs.quinquenios >= 4) { setInputs(prev => ({ ...prev, hasSextaParte: true })); } else { setInputs(prev => ({ ...prev, hasSextaParte: false })); } }, [inputs.quinquenios]);
          
          // --- EFFECT FOR RESETTING PRO LABORE ON CAREER CHANGE ---
          useEffect(() => {
            handleInputChange('proLaboreFunction', 'none');
          }, [inputs.selectedCareer]);

          // --- HANDLERS ---
          const handleInputChange = (field, value) => setInputs(prev => ({ ...prev, [field]: value }));
          const handleCareerChange = (e) => { const newCareer = e.target.value; setInputs(prev => ({ ...prev, selectedCareer: newCareer, selectedClass: Object.keys(salaryData[newCareer])[0] })); };
          const handleTemporalToggle = (enabled) => {
            handleInputChange('showTemporalBenefits', enabled);
            if (!enabled) {
                handleInputChange('quinquenios', 0);
            }
          };

          // --- CALCULATION LOGIC ---
          const results = useMemo(() => {
            const baseSalary = salaryData[inputs.selectedCareer]?.[inputs.selectedClass] || 0;
            const retp = baseSalary;
            
            let proLaboreValue = 0;
            let proLaboreBase = 0;
            let proLaborePercent = 0;
            if (inputs.showProLabore && proLaboreCareerType && inputs.proLaboreFunction !== 'none') {
                const functions = proLaboreData[proLaboreCareerType];
                proLaborePercent = functions[inputs.proLaboreFunction];
                if (proLaboreCareerType === 'operacionais' || proLaboreCareerType === 'delegados') {
                    proLaboreBase = salaryData[inputs.selectedCareer]['Classe Especial'];
                } else { // peritos
                    proLaboreBase = baseSalary;
                }
                proLaboreValue = proLaboreBase * proLaborePercent;
            }

            let quinquenioValue = 0, sextaParteValue = 0;
            if (inputs.showTemporalBenefits) {
                const isJudicial = inputs.calculationBase === 'judicial';
                const qqBase = (isJudicial ? (baseSalary + retp) : baseSalary) + proLaboreValue;
                quinquenioValue = (qqBase * 0.05) * inputs.quinquenios;
                
                if (inputs.hasSextaParte) {
                    const spBase = (isJudicial ? (baseSalary + retp + quinquenioValue) : (baseSalary + quinquenioValue)) + proLaboreValue;
                    sextaParteValue = spBase / 6;
                }
            }
            
            const adpjValue = inputs.selectedCareer === "Delegado de Polícia" ? (baseSalary + retp) * constants.adpjCoefficient : 0;
            const insalubridadeLevel = activityToLevelMap[inputs.activityType];
            const insalubridadeValue = insalubridadeValues[insalubridadeLevel] || 0;
            const grossSalary = baseSalary + retp + proLaboreValue + quinquenioValue + sextaParteValue + adpjValue + insalubridadeValue;
            
            let iamspeDiscount = 0;
            if (inputs.iamspeContributionType !== 'exempt') {
                const titularRate = inputs.iamspeContributionType === 'over59' ? iamspeRates.titular.over59 : iamspeRates.titular.under59;
                iamspeDiscount = grossSalary * titularRate;
                if (inputs.includeIamspeDependents) {
                    iamspeDiscount += (inputs.beneficiariosUnder59 * grossSalary * iamspeRates.beneficiario.under59);
                    iamspeDiscount += (inputs.beneficiariosOver59 * grossSalary * iamspeRates.beneficiario.over59);
                    iamspeDiscount += (inputs.agregadosUnder59 * grossSalary * iamspeRates.agregado.under59);
                    iamspeDiscount += (inputs.agregadosOver59 * grossSalary * iamspeRates.agregado.over59);
                }
            }
            
            const spprevBase = inputs.pensionRegime === 'rpc' ? Math.min(grossSalary, constants.inssCeiling) : grossSalary;
            const spprevDiscount = calculateSpprev(spprevBase);
            
            let prevcomDiscount = 0;
            if (inputs.pensionRegime === 'rpc' && inputs.showPrevcom && grossSalary > constants.inssCeiling) {
                const prevcomBase = grossSalary - constants.inssCeiling;
                prevcomDiscount = prevcomBase * (inputs.prevcomPercentage / 100);
            }

            const irpfBase = grossSalary - spprevDiscount - iamspeDiscount - prevcomDiscount - (inputs.irpfDependents * constants.irpfDeductionPerDependent);
            const irpfDiscount = calculateIrpf(irpfBase);
            const totalDiscounts = spprevDiscount + iamspeDiscount + prevcomDiscount + irpfDiscount;
            
            const abonoPermanenciaValue = inputs.hasAbono ? spprevDiscount : 0;
            
            let alimentacaoValue = 0;
            if (inputs.showAlimentacao) {
              const num12h = Math.min(inputs.plantao12h, alimentacaoRules.limite12h);
              const num8h = Math.min(inputs.plantao8h, alimentacaoRules.limite8h);
              const totalAlimentacao = (num12h * alimentacaoRules.valor12h) + (num8h * alimentacaoRules.valor8h);
              alimentacaoValue = Math.min(totalAlimentacao, alimentacaoRules.limiteMensalTotal);
            }

            let dejecValue = 0;
            if (inputs.showDejec) {
                const isDelegado = inputs.selectedCareer === "Delegado de Polícia";
                const dejecCoefficient = isDelegado ? constants.dejecCoefficients.delegado : constants.dejecCoefficients.outros;
                dejecValue = inputs.dejecDiarias * dejecCoefficient * constants.ufesp;
            }

            let gatValue = 0;
            if (inputs.showGat && inputs.selectedCareer === "Delegado de Polícia") {
                gatValue = (baseSalary / 30) * inputs.gatDays;
            }
            
            const netSalary = grossSalary - totalDiscounts + abonoPermanenciaValue + alimentacaoValue + dejecValue + gatValue;
            return { baseSalary, retp, proLaboreValue, proLaboreBase, proLaborePercent, quinquenioValue, sextaParteValue, adpjValue, insalubridadeValue, insalubridadeLevel, grossSalary, spprevBase, spprevDiscount, prevcomDiscount, irpfDiscount, iamspeDiscount, totalDiscounts, abonoPermanenciaValue, alimentacaoValue, dejecValue, gatValue, netSalary };
          }, [inputs]);

          return (
            <div className="bg-gray-900 text-white min-h-screen font-sans p-4 sm:p-8 flex justify-center">
              <div className="w-full max-w-6xl">
                <div className="text-center mb-8">
                  <h1 className="text-4xl font-bold text-cyan-400">Simulador de Remuneração</h1>
                  <p className="text-lg text-gray-400 mt-1">Polícia Civil de São Paulo</p>
                </div>

                <div className="grid grid-cols-1 lg:grid-cols-2 gap-8">
                  {/* --- INPUTS COLUMN --- */}
                  <div className="bg-gray-800 rounded-2xl shadow-lg p-6 sm:p-8 flex flex-col space-y-6">
                    <InputSection icon={Briefcase} title="Cargo e Classe">
                      <Select label="Cargo" value={inputs.selectedCareer} onChange={handleCareerChange} options={careerOptions} />
                      <Select label="Classe" value={inputs.selectedClass} onChange={(e) => handleInputChange('selectedClass', e.target.value)} options={classOptions} />
                    </InputSection>

                    <InputSection icon={University} title="Regime de Previdência">
                        <div className="relative" onMouseEnter={() => toggleTooltip('pensionRegime')} onMouseLeave={() => toggleTooltip('pensionRegime')}>
                            <Select 
                                label={<div className="flex items-center gap-2"><span>Regime Previdenciário</span><HelpCircle className="w-4 h-4 text-gray-400 cursor-help" /></div>}
                                value={inputs.pensionRegime} 
                                onChange={(e) => handleInputChange('pensionRegime', e.target.value)}
                                options={[
                                    { value: 'rpps', label: 'Regime Antigo (Ingresso até 20/01/2013)' },
                                    { value: 'rpc', label: 'Regime Novo (Ingresso após 20/01/2013)' }
                                ]}
                            />
                            {showTooltips.pensionRegime && <PensionRegimeTooltip />}
                        </div>
                        {inputs.pensionRegime === 'rpc' && (
                            <div className="pt-4 border-t border-gray-700">
                                <div className="relative" onMouseEnter={() => toggleTooltip('prevcomExplanation')} onMouseLeave={() => toggleTooltip('prevcomExplanation')}>
                                    <ToggleSwitch
                                        label={<div className="flex items-center gap-2"><span>Aderir à SP-PREVCOM</span><HelpCircle className="w-4 h-4 text-gray-400 cursor-help" /></div>}
                                        enabled={inputs.showPrevcom}
                                        setEnabled={(v) => handleInputChange('showPrevcom', v)}
                                        helpText="Contribuição opcional para previdência complementar."
                                    />
                                    {showTooltips.prevcomExplanation && <PrevcomTooltip />}
                                </div>
                                {inputs.showPrevcom && (
                                    <div className="mt-4">
                                        <NumberInput 
                                            label="Alíquota de Contribuição (%)"
                                            value={inputs.prevcomPercentage}
                                            onChange={(v) => handleInputChange('prevcomPercentage', v)}
                                            max={7.5}
                                            helpText="Máximo de 7,5% para contrapartida do Estado."
                                        />
                                    </div>
                                )}
                            </div>
                        )}
                    </InputSection>

                    <InputSection icon={Clock} title="Vantagens Temporais">
                        <ToggleSwitch
                            label="Calcular Vantagens Temporais"
                            enabled={inputs.showTemporalBenefits}
                            setEnabled={handleTemporalToggle}
                            helpText="Ative para adicionar Quinquênio e Sexta-Parte."
                        />
                        {inputs.showTemporalBenefits && (
                            <div className="space-y-4 mt-4 pt-4 border-t border-gray-700">
                                <div className="relative" onMouseEnter={() => toggleTooltip('temporalCalculation')} onMouseLeave={() => toggleTooltip('temporalCalculation')}>
                                    <Select 
                                        label={<div className="flex items-center gap-2"><span>Base de Cálculo</span><HelpCircle className="w-4 h-4 text-gray-400 cursor-help" /></div>}
                                        value={inputs.calculationBase} 
                                        onChange={(e) => handleInputChange('calculationBase', e.target.value)} 
                                        options={[
                                            { value: 'admin', label: 'Cálculo Administrativo (Padrão)' },
                                            { value: 'judicial', label: 'Cálculo Judicial (Venc. Integrais)' }
                                        ]} 
                                    />
                                    {showTooltips.temporalCalculation && <TemporalCalculationTooltip />}
                                </div>
                                <NumberInput 
                                    label="Nº de Quinquênios" 
                                    value={inputs.quinquenios} 
                                    onChange={(v) => handleInputChange('quinquenios', v)}
                                    helpText={inputs.quinquenios >= 4 ? "Sexta-parte (20 anos) calculada automaticamente." : null}
                                />
                            </div>
                        )}
                    </InputSection>

                    <InputSection icon={Award} title="Outras Vantagens">
                        <div>
                            <div className="flex items-center gap-2 relative w-fit" onMouseEnter={() => toggleTooltip('insalubridadePortaria')} onMouseLeave={() => toggleTooltip('insalubridadePortaria')} >
                                <label className="block text-sm font-medium text-gray-300 mb-1"> Tipo de Atividade (Insalubridade) </label>
                                <HelpCircle className="w-4 h-4 text-gray-400 cursor-help" />
                                {showTooltips.insalubridadePortaria && <InsalubridadePortariaTooltip />}
                            </div>
                            <Select value={inputs.activityType} onChange={(e) => handleInputChange('activityType', e.target.value)} options={activityOptions.map(o => ({value: o, label: o}))} helpText="Define o adicional de insalubridade." />
                        </div>
                        <Checkbox label="Abono de Permanência" checked={inputs.hasAbono} onChange={(v) => handleInputChange('hasAbono', v)} helpText="Para quem já pode se aposentar mas continua na ativa." />
                        {proLaboreCareerType && (
                            <div className="pt-4 border-t border-gray-700">
                                <div className="relative" onMouseEnter={() => toggleTooltip('proLaboreExplanation')} onMouseLeave={() => toggleTooltip('proLaboreExplanation')}>
                                    <ToggleSwitch
                                        label={<div className="flex items-center gap-2"><span>Calcular Gratificação Pro Labore</span><HelpCircle className="w-4 h-4 text-gray-400 cursor-help" /></div>}
                                        enabled={inputs.showProLabore}
                                        setEnabled={(v) => handleInputChange('showProLabore', v)}
                                    />
                                    {showTooltips.proLaboreExplanation && <ProLaboreExplanationTooltip />}
                                </div>
                                {inputs.showProLabore && (
                                    <div className="mt-4">
                                        <Select 
                                            label="Função de Chefia/Direção"
                                            value={inputs.proLaboreFunction}
                                            onChange={(e) => handleInputChange('proLaboreFunction', e.target.value)}
                                            options={proLaboreOptions}
                                        />
                                    </div>
                                )}
                            </div>
                        )}
                    </InputSection>
                    
                    <InputSection icon={Users} title="Dependentes e IRPF">
                         <NumberInput label="Nº de Dependentes (para IRPF)" value={inputs.irpfDependents} onChange={(v) => handleInputChange('irpfDependents', v)} helpText="Reduz a base de cálculo do Imposto de Renda." />
                    </InputSection>

                    <InputSection icon={Shield} title="Contribuição IAMSPE">
                        <div className="relative" onMouseEnter={() => toggleTooltip('iamspeContribution')} onMouseLeave={() => toggleTooltip('iamspeContribution')}>
                            <Select 
                                label={<div className="flex items-center gap-2"><span>Modalidade da Contribuição</span><HelpCircle className="w-4 h-4 text-gray-400 cursor-help" /></div>}
                                value={inputs.iamspeContributionType} 
                                onChange={(e) => handleInputChange('iamspeContributionType', e.target.value)}
                                options={[
                                    { value: 'under59', label: 'Menos de 59 anos (Obrigatório)' },
                                    { value: 'over59', label: '59 anos ou mais (Obrigatório)' },
                                    { value: 'exempt', label: 'Sem Contribuição (Decisão Judicial)' }
                                ]}
                            />
                            {showTooltips.iamspeContribution && <IamspeContributionTooltip />}
                        </div>
                        {inputs.iamspeContributionType !== 'exempt' && (
                            <>
                                <ToggleSwitch label="Incluir beneficiários e/ou agregados" enabled={inputs.includeIamspeDependents} setEnabled={(v) => handleInputChange('includeIamspeDependents', v)} helpText="Ative para adicionar outras pessoas ao cálculo." />
                                {inputs.includeIamspeDependents && (
                                    <div className="space-y-4 mt-4 pt-4 border-t border-gray-700">
                                        <NumberInput label="Beneficiários (< 59 anos)" value={inputs.beneficiariosUnder59} onChange={(v) => handleInputChange('beneficiariosUnder59', v)} />
                                        <NumberInput label="Beneficiários (59+ anos)" value={inputs.beneficiariosOver59} onChange={(v) => handleInputChange('beneficiariosOver59', v)} />
                                        <NumberInput label="Agregados (< 59 anos)" value={inputs.agregadosUnder59} onChange={(v) => handleInputChange('agregadosUnder59', v)} />
                                        <NumberInput label="Agregados (59+ anos)" value={inputs.agregadosOver59} onChange={(v) => handleInputChange('agregadosOver59', v)} />
                                    </div>
                                )}
                            </>
                        )}
                    </InputSection>
                    
                    <InputSection icon={HandCoins} title="Indenizações">
                        <div className="relative" onMouseEnter={() => toggleTooltip('alimentacaoRules')} onMouseLeave={() => toggleTooltip('alimentacaoRules')}>
                            <ToggleSwitch label={<div className="flex items-center gap-2"><span>Calcular Ajuda de Custo (Alimentação)</span><HelpCircle className="w-4 h-4 text-gray-400 cursor-help" /></div>} enabled={inputs.showAlimentacao} setEnabled={(v) => handleInputChange('showAlimentacao', v)} />
                            {showTooltips.alimentacaoRules && <AlimentacaoRulesTooltip />}
                        </div>
                        {inputs.showAlimentacao && (
                            <div className="space-y-4 mt-2 pt-4 border-t border-gray-700/50">
                                <NumberInput label="Nº de plantões de 12h ou mais" value={inputs.plantao12h} onChange={(v) => handleInputChange('plantao12h', v)} max={alimentacaoRules.limite12h} helpText={`Limite: ${alimentacaoRules.limite12h}/mês.`} />
                                <NumberInput label="Nº de plantões de 8h a 12h" value={inputs.plantao8h} onChange={(v) => handleInputChange('plantao8h', v)} max={alimentacaoRules.limite8h} helpText={`Limite: ${alimentacaoRules.limite8h}/mês.`} />
                            </div>
                        )}
                        <div className="relative pt-4 border-t border-gray-700" onMouseEnter={() => toggleTooltip('dejecExplanation')} onMouseLeave={() => toggleTooltip('dejecExplanation')}>
                            <ToggleSwitch label={<div className="flex items-center gap-2"><span>Calcular DEJEC</span><HelpCircle className="w-4 h-4 text-gray-400 cursor-help" /></div>} enabled={inputs.showDejec} setEnabled={(v) => handleInputChange('showDejec', v)} />
                            {showTooltips.dejecExplanation && <DejecExplanationTooltip />}
                        </div>
                        {inputs.showDejec && (
                            <div className="space-y-4 mt-2 pt-4 border-t border-gray-700/50">
                                <NumberInput label="Nº de Diárias DEJEC" value={inputs.dejecDiarias} onChange={(v) => handleInputChange('dejecDiarias', v)} max={10} helpText="Limite: 10 diárias/mês." />
                            </div>
                        )}
                        {inputs.selectedCareer === "Delegado de Polícia" && (
                             <div className="relative pt-4 border-t border-gray-700" onMouseEnter={() => toggleTooltip('gatExplanation')} onMouseLeave={() => toggleTooltip('gatExplanation')}>
                                <ToggleSwitch label={<div className="flex items-center gap-2"><span>Calcular GAT</span><HelpCircle className="w-4 h-4 text-gray-400 cursor-help" /></div>} enabled={inputs.showGat} setEnabled={(v) => handleInputChange('showGat', v)} />
                                {showTooltips.gatExplanation && <GatExplanationTooltip />}
                            </div>
                        )}
                        {inputs.showGat && inputs.selectedCareer === "Delegado de Polícia" && (
                            <div className="space-y-4 mt-2 pt-4 border-t border-gray-700/50">
                                <NumberInput label="Nº de Dias de Acúmulo (GAT)" value={inputs.gatDays} onChange={(v) => handleInputChange('gatDays', v)} max={30} />
                            </div>
                        )}
                    </InputSection>
                  </div>

                  {/* --- RESULTS COLUMN --- */}
                  <div className="bg-gray-800 rounded-2xl shadow-lg p-6 sm:p-8 flex flex-col">
                    <div className="flex items-center gap-3 mb-6"> <FileText className="w-8 h-8 text-cyan-400" /> <h2 className="text-2xl font-bold text-center text-cyan-400">Detalhamento da Remuneração</h2> </div>
                    <div className="space-y-4 flex-grow">
                        <div className="p-4 bg-gray-900/50 rounded-lg">
                            <h3 className="font-semibold text-green-400 mb-2 border-b border-green-400/20 pb-2">Vencimentos Brutos</h3>
                            <div className="relative" onMouseEnter={() => toggleTooltip('baseSalary')} onMouseLeave={() => toggleTooltip('baseSalary')}>
                                <ResultRow label={<div className="flex items-center gap-2"><span>Salário Base (Padrão)</span><HelpCircle className="w-4 h-4 text-gray-400 cursor-help" /></div>} value={formatCurrency(results.baseSalary)}>
                                    <ResultSubRow label="Cargo" value={inputs.selectedCareer} />
                                    <ResultSubRow label="Classe" value={inputs.selectedClass} />
                                </ResultRow>
                                {showTooltips.baseSalary && <BaseSalaryTooltip />}
                            </div>
                            <div className="relative" onMouseEnter={() => toggleTooltip('retp')} onMouseLeave={() => toggleTooltip('retp')}>
                                <ResultRow label={<div className="flex items-center gap-2"><span>RETP (100%)</span><HelpCircle className="w-4 h-4 text-gray-400 cursor-help" /></div>} value={formatCurrency(results.retp)} />
                                {showTooltips.retp && <RetpExplanationTooltip />}
                            </div>
                            {results.proLaboreValue > 0 && (
                                <div className="relative" onMouseEnter={() => toggleTooltip('proLaboreCalculation')} onMouseLeave={() => toggleTooltip('proLaboreCalculation')}>
                                    <ResultRow label={<div className="flex items-center gap-2"><span>Gratificação Pro Labore</span><HelpCircle className="w-4 h-4 text-gray-400 cursor-help" /></div>} value={formatCurrency(results.proLaboreValue)}>
                                        <ResultSubRow label="Função" value={inputs.proLaboreFunction} />
                                    </ResultRow>
                                    {showTooltips.proLaboreCalculation && <ProLaboreCalculationTooltip base={results.proLaboreBase} percent={results.proLaborePercent} careerType={proLaboreCareerType} />}
                                </div>
                            )}
                            {inputs.showTemporalBenefits && inputs.quinquenios > 0 && (
                                <ResultRow label="Quinquênios" value={formatCurrency(results.quinquenioValue)}>
                                    <ResultSubRow label="Nº" value={inputs.quinquenios} />
                                    <ResultSubRow label="Método" value={inputs.calculationBase === 'judicial' ? 'Judicial' : 'Administrativo'} />
                                </ResultRow>
                            )}
                            {inputs.showTemporalBenefits && inputs.hasSextaParte && 
                                <ResultRow label="Sexta-Parte" value={formatCurrency(results.sextaParteValue)}>
                                     <ResultSubRow label="Método" value={inputs.calculationBase === 'judicial' ? 'Judicial' : 'Administrativo'} />
                                </ResultRow>
                            }
                            {results.adpjValue > 0 && ( <div className="relative" onMouseEnter={() => toggleTooltip('adpj')} onMouseLeave={() => toggleTooltip('adpj')}> <ResultRow label={<div className="flex items-center gap-2"><span>ADPJ</span><HelpCircle className="w-4 h-4 text-gray-400 cursor-help" /></div>} value={formatCurrency(results.adpjValue)} /> {showTooltips.adpj && <AdpjExplanationTooltip />} </div> )}
                            {results.insalubridadeValue > 0 && ( <div className="relative" onMouseEnter={() => toggleTooltip('insalubridadeValue')} onMouseLeave={() => toggleTooltip('insalubridadeValue')}> <ResultRow label={<div className="flex items-center gap-2"><span>{`Adc. Insalubridade (${results.insalubridadeLevel})`}</span><HelpCircle className="w-4 h-4 text-gray-400 cursor-help" /></div>} value={formatCurrency(results.insalubridadeValue)}>
                                <ResultSubRow label="Atividade" value={inputs.activityType} />
                            </ResultRow> {showTooltips.insalubridadeValue && <InsalubridadeValueTooltip />} </div> )}
                            <ResultRow label="TOTAL BRUTO" value={formatCurrency(results.grossSalary)} isTotal={true} type="positive" />
                        </div>

                        <div className="p-4 bg-gray-900/50 rounded-lg">
                            <h3 className="font-semibold text-red-400 mb-2 border-b border-red-400/20 pb-2">Descontos</h3>
                            <div className="relative" onMouseEnter={() => toggleTooltip('spprev')} onMouseLeave={() => toggleTooltip('spprev')}>
                                <ResultRow label={<div className="flex items-center gap-2"><span>Contribuição SPPREV</span><HelpCircle className="w-4 h-4 text-gray-400 cursor-help" /></div>} value={`-${formatCurrency(results.spprevDiscount)}`}>
                                     <ResultSubRow label="Base de Cálculo" value={formatCurrency(results.spprevBase)} />
                                </ResultRow>
                                {showTooltips.spprev && <SpprevExplanationTooltip />}
                            </div>
                            
                            {results.prevcomDiscount > 0 && (
                                <ResultRow label="Contribuição SP-PREVCOM" value={`-${formatCurrency(results.prevcomDiscount)}`}>
                                    <ResultSubRow label="Alíquota" value={`${inputs.prevcomPercentage}%`} />
                                </ResultRow>
                            )}

                            {inputs.iamspeContributionType !== 'exempt' && (
                                <div className="relative" onMouseEnter={() => toggleTooltip('iamspe')} onMouseLeave={() => toggleTooltip('iamspe')}>
                                    <ResultRow label={<div className="flex items-center gap-2"><span>Contribuição IAMSPE</span><HelpCircle className="w-4 h-4 text-gray-400 cursor-help" /></div>} value={`-${formatCurrency(results.iamspeDiscount)}`} helpText={inputs.includeIamspeDependents ? "Cálculo: Titular + Dependentes" : "Cálculo: Apenas Titular"}>
                                        {inputs.includeIamspeDependents && (
                                            <>
                                                {inputs.beneficiariosUnder59 > 0 && <ResultSubRow label="Beneficiários (< 59 anos)" value={inputs.beneficiariosUnder59} />}
                                                {inputs.beneficiariosOver59 > 0 && <ResultSubRow label="Beneficiários (59+ anos)" value={inputs.beneficiariosOver59} />}
                                                {inputs.agregadosUnder59 > 0 && <ResultSubRow label="Agregados (< 59 anos)" value={inputs.agregadosUnder59} />}
                                                {inputs.agregadosOver59 > 0 && <ResultSubRow label="Agregados (59+ anos)" value={inputs.agregadosOver59} />}
                                            </>
                                        )}
                                    </ResultRow>
                                    {showTooltips.iamspe && <IamspeExplanationTooltip />}
                                </div>
                            )}

                            <div className="relative" onMouseEnter={() => toggleTooltip('irpf')} onMouseLeave={() => toggleTooltip('irpf')}>
                                <ResultRow label={<div className="flex items-center gap-2"><span>Imposto de Renda (IRPF)</span><HelpCircle className="w-4 h-4 text-gray-400 cursor-help" /></div>} value={`-${formatCurrency(results.irpfDiscount)}`}>
                                    {inputs.irpfDependents > 0 && <ResultSubRow label="Nº de Dependentes" value={inputs.irpfDependents} />}
                                </ResultRow>
                                {showTooltips.irpf && <IrpfExplanationTooltip />}
                            </div>
                            <ResultRow label="TOTAL DE DESCONTOS" value={formatCurrency(results.totalDiscounts)} isTotal={true} type="negative" />
                        </div>

                        {(results.abonoPermanenciaValue > 0 || results.alimentacaoValue > 0 || results.dejecValue > 0 || results.gatValue > 0) && (
                            <div className="p-4 bg-gray-900/50 rounded-lg">
                                <h3 className="font-semibold text-blue-400 mb-2 border-b border-blue-400/20 pb-2">Outras Verbas e Indenizações</h3>
                                {results.abonoPermanenciaValue > 0 && <ResultRow label="Abono de Permanência" value={`+${formatCurrency(results.abonoPermanenciaValue)}`} />}
                                {results.alimentacaoValue > 0 && ( <div className="relative" onMouseEnter={() => toggleTooltip('alimentacaoValues')} onMouseLeave={() => toggleTooltip('alimentacaoValues')}> <ResultRow label={<div className="flex items-center gap-2"><span>Ajuda de Custo (Alimentação)</span><HelpCircle className="w-4 h-4 text-gray-400 cursor-help" /></div>} value={`+${formatCurrency(results.alimentacaoValue)}`}>
                                    {inputs.plantao12h > 0 && <ResultSubRow label="Plantões de 12h ou mais" value={inputs.plantao12h} />}
                                    {inputs.plantao8h > 0 && <ResultSubRow label="Plantões de 8h a 12h" value={inputs.plantao8h} />}
                                </ResultRow> {showTooltips.alimentacaoValues && <AlimentacaoValuesTooltip />} </div> )}
                                {results.dejecValue > 0 && ( <div className="relative" onMouseEnter={() => toggleTooltip('dejecCalculation')} onMouseLeave={() => toggleTooltip('dejecCalculation')}> <ResultRow label={<div className="flex items-center gap-2"><span>DEJEC</span><HelpCircle className="w-4 h-4 text-gray-400 cursor-help" /></div>} value={`+${formatCurrency(results.dejecValue)}`}>
                                    <ResultSubRow label="Nº de Diárias" value={inputs.dejecDiarias} />
                                </ResultRow> {showTooltips.dejecCalculation && <DejecCalculationTooltip />} </div> )}
                                {results.gatValue > 0 && ( <div className="relative" onMouseEnter={() => toggleTooltip('gatCalculation')} onMouseLeave={() => toggleTooltip('gatCalculation')}> <ResultRow label={<div className="flex items-center gap-2"><span>GAT</span><HelpCircle className="w-4 h-4 text-gray-400 cursor-help" /></div>} value={`+${formatCurrency(results.gatValue)}`}>
                                    <ResultSubRow label="Dias de Acúmulo" value={inputs.gatDays} />
                                </ResultRow> {showTooltips.gatCalculation && <GatCalculationTooltip base={results.baseSalary} days={inputs.gatDays} />} </div> )}
                            </div>
                        )}
                    </div>
                    
                    <div className="mt-6 text-center text-sm text-gray-400 space-y-2">
                        <p>Desenvolvido por <a href="https://www.instagram.com/provaspcsp2023/" target="_blank" rel="noopener noreferrer" className="text-cyan-400 hover:underline">@provaspcsp2023</a></p>
                        <p><a href="https://nubank.com.br/cobrar/1ksi1j/65ee0f76-c3a3-4188-a5d7-7eb9daf37a59" target="_blank" rel="noopener noreferrer" className="text-green-400 hover:underline">💚 Contribuir via Pix</a></p>
                    </div>

                    <div className="mt-4 p-6 bg-cyan-900/30 rounded-lg text-center ring-1 ring-cyan-500">
                        <h3 className="text-xl font-semibold text-gray-300 mb-2">Remuneração Líquida Estimada</h3>
                        <p className="text-4xl lg:text-5xl font-extrabold text-cyan-400 tracking-wider font-mono">{formatCurrency(results.netSalary)}</p>
                        <p className="text-xs text-gray-400 mt-2">(Total Bruto - Descontos + Indenizações)</p>
                    </div>
                    <div className="mt-6 text-center text-xs text-gray-500 flex items-center justify-center gap-2"> <AlertTriangle className="w-4 h-4" /> <p><strong>Aviso:</strong> Esta é uma ferramenta de simulação, que não vincula a administração pública.
                    <br />
                    Os valores são estimativas e podem variar.
                    <br />
                    v. 1.2 // Última atualização: 04/07/2025 </p> </div>
                  </div>
                </div>
                <FloatingAuthorButton />
              </div>
            </div>
          );
        }
        
        // --- RENDER THE APP ---
        ReactDOM.render(<App />, document.getElementById('root'));

    </script>
</body>
</html>
